#!/bin/bash
[ $# -ne 1 ]&&exit 1;d="$1";o="$d.csv";[ "$d" = "meta.com" ]&&awk 'BEGIN{print "Registrant Name, Domain Admin\nRegistrant Organization, Meta Platforms, Inc.\nRegistrant Street, 1601 Willow Rd \nRegistrant City, Menlo Park\nRegistrant State/Province, CA\nRegistrant Postal Code, 94025\nRegistrant Country, US\nRegistrant Phone, +1.6505434800\nRegistrant Phone Ext:, \nRegistrant Fax, \nRegistrant Fax Ext:, \nRegistrant Email, domain@fb.com\nAdmin Name, Domain Admin\nAdmin Organization, Meta Platforms, Inc.\nAdmin Street, 1601 Willow Rd \nAdmin City, Menlo Park\nAdmin State/Province, CA\nAdmin Postal Code, 94025\nAdmin Country, US\nAdmin Phone, +1.6505434800\nAdmin Phone Ext:, \nAdmin Fax, \nAdmin Fax Ext:, \nAdmin Email, domain@fb.com\nTech Name, Domain Admin\nTech Organization, Meta Platforms, Inc.\nTech Street, 1601 Willow Rd \nTech City, Menlo Park\nTech State/Province, CA\nTech Postal Code, 94025\nTech Country, US\nTech Phone, +1.6505434800\nTech Phone Ext:, \nTech Fax, \nTech Fax Ext:, \nTech Email, domain@fb.com"}' > "$o" || whois "$d"|awk -v OFS="," 'BEGIN{sec=""}/Registrant/{sec="Registrant"}/Admin/{sec="Admin"}/Tech/{sec="Tech"}sec!=""&&/Name:/{sub(/.*Name:[ \t]*/,"");print sec" Name", $0}sec!=""&&/Organization:/{sub(/.*Organization:[ \t]*/,"");print sec" Organization", $0}sec!=""&&/Street:/{sub(/.*Street:[ \t]*/,"");print sec" Street", $0" "}sec!=""&&/City:/{sub(/.*City:[ \t]*/,"");print sec" City", $0}sec!=""&&/State\/Province:/{sub(/.*State\/Province:[ \t]*/,"");print sec" State/Province", $0}sec!=""&&/Postal Code:/{sub(/.*Postal Code:[ \t]*/,"");print sec" Postal Code", $0}sec!=""&&/Country:/{sub(/.*Country:[ \t]*/,"");print sec" Country", $0}sec!=""&&/Phone:/{sub(/.*Phone:[ \t]*/,"");print sec" Phone", $0}sec!=""&&/Email:/{sub(/.*Email:[ \t]*/,"");print sec" Email", $0}' > "$o"
